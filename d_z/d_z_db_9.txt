 
--4.    Вывести номера зачеток только студентов физико-технического факультета.

SELECT z.N_Z
FROM Zachetki z
WHERE z.Id_Studenta IN
    (SELECT e.Id_St
    FROM Exzamen e
    WHERE e.Id_St IN
        (SELECT s.ID_St
        FROM Student s
        WHERE s."Group" IN
            (SELECT g."Group"
            FROM G g
            WHERE g.Kafedra IN 
                (SELECT k.Kafedra
                FROM Kafedra k
                WHERE Decanat = 'Физико-технический')
            )
        )
    );                             	

--5.    Выведите студентов физико-технического факультета сдавших иностранный язык на 5.

SELECT s.FIO, e.Ball   
FROM Student s, Exzamen e
WHERE  s.ID_St=e.Id_St AND  e.Predmet = "Иностр. язык" AND
    s."Group" IN
            (SELECT g."Group"
            FROM G g
            WHERE g.Kafedra IN
                (SELECT k.Kafedra
                FROM Kafedra k
                WHERE k.Decanat='Физико-технический')  
            )
GROUP BY s.FIO
HAVING e.Ball =5; 

--6.    Подсчитать сколько различных предметов сдавалось в сессию.

SELECT DISTINCT(Predmet)
FROM Exzamen;

--7.    Напишите запрос, который выводит средний балл по экзаменам Васильевой.

SELECT AVG(e.Ball)
FROM Exzamen e, Student s
WHERE e.Id_St=s.ID_St AND s.FIO LIKE 'Васильева%';
 
--8.    Определите сколько человек учится на каждой специальности.

SELECT COUNT(FIO) AS [Кол-во человек], Special AS [Специальность]
FROM Student  
GROUP BY Special;
 
--9.    Напишите запрос, который покажет все группы физико-технического факультета.

SELECT g."Group"
FROM G g, Kafedra k
WHERE k.Decanat = 'Физико-технический' AND g.Kafedra=k.Kafedra
GROUP BY k.Decanat;
 
--10.    Вывести список фамилий студентов получивших 5 баллов по дифференциальным уравнениям.
 
SELECT s.FIO, e.Predmet, e.Ball
FROM EXZAMEN e, Student s
WHERE e.id_st=s.ID_st AND e.Predmet='Дифференциальные уравнения' AND e.Ball='5';

--11.    Напишите запрос, который покажет,  сколько экзаменов  сдавал Шутов.

SELECT COUNT(e.Predmet)
FROM Exzamen e, Student s
WHERE e.Id_St=s.ID_St AND s.FIO LIKE 'Шутов%'; 

--12.    Выведите название кафедры студентов, не сдавших хотя бы один экзамен.

SELECT g.Kafedra
FROM G g  
WHERE g."Group" IN
    (SELECT s."Group"
    FROM Student s
    WHERE s.ID_St IN
        (SELECT e.Id_st
        FROM Exzamen e
        WHERE e.Predmet LIKE 'Иностр. язык')
    );        
 
--13.    Подсчитать количество кафедр на каждом факультете.

SELECT COUNT(Kafedra),Decanat AS [Факультет]
FROM Kafedra k
GROUP BY Decanat;
 
--14.    Подсчитать количество пятерок на физико-математическом факультете.

SELECT COUNT(e.BALL) AS [Кол-во 5-к на физ-мате]
FROM Exzamen e
WHERE e.Ball LIKE '5'
AND e.Id_st IN
    (SELECT s.ID_st
    FROM Student s
    WHERE s."Group" IN
        (SELECT g."Group"
        FROM G g
        WHERE g.Kafedra IN
            (SELECT k.Kafedra
            FROM Kafedra k
            WHERE k.Decanat LIKE 'Физико-математический')
        )
    );
 
--15.    Определите номера зачетных книжек группы ФТ151

SELECT z.N_Z AS [номера зачетных книжек группы ФТ151]
FROM Zachetki z, Exzamen e, Student s
WHERE z.Id_Studenta=e.Id_St AND e.Id_St=s.ID_St AND s."Group" LIKE 'ФТ151';
 
--16.    Выведите перечень специальностей физико-математического факультета.

SELECT s.Special AS [перечень специальностей физико-математического факультета]
FROM Student s
WHERE s."Group" IN
    (SELECT g."Group"
    FROM G g
    WHERE g.Kafedra IN
        (SELECT k.Kafedra
        FROM Kafedra k
        WHERE k.Decanat LIKE 'Физико-математический')
    )
GROUP BY s.Special; 